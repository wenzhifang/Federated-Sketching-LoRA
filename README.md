## Federated Sketching LoRA: On-Device Collaborative Fine-Tuning of Large Language Models

[![python](https://img.shields.io/badge/Python_3.10-306998?logo=python&logoColor=FFD43B)](https://www.python.org/downloads/release/python-31012/)
[![License: MIT](https://img.shields.io/badge/license-MIT-750014.svg)](https://opensource.org/licenses/MIT) 

---
ICML Submission 2308

---

## ğŸ”¥ Our Framework

We present **Federated Sketching LoRA** (FSLoRA), a novel methodology that retains LoRA's scalability while adapting to the communication and computational capabilities of individual devices.

<div align="center">
    <img src="figures/Overview.png" alt="overview" style="width:60%;"/>
</div>


## ğŸ–¥ï¸ Prerequisites

Install the required packages via:
```bash
pip install -r requirements.txt
```

Alternatively, ensure the following dependencies are installed:
```plaintext
python == 3.10.14
torch == 2.5.1
transformers == 4.47.1
peft == 0.14.0
accelerate == 1.2.1
bitsandbytes == 0.45.0
datasets == 3.2.0
```

## ğŸ—‚ï¸ Folder Structure
```
FSLoRA/
â”‚   README.md
â”‚   requirements.txt
â”‚
â”œâ”€â”€â”€ main/
â”‚   â”‚   main.py
â”‚   â”‚   models.py
â”‚   â”‚   utils.py
â”‚   â”‚   options.py 
â”‚   â””â”€â”€â”€ results/
â”‚       â”‚   results.pkl
```

- **`main/`**: Contains the primary codebase.
  - `main.py`: Entry point of the system.
  - `models.py`: Includes model definitions such as FSLoRA`.
  - `utils.py`: Contains utility functions for tasks like data processing, env, and evaluation.
  - `options.py`: Manages command-line arguments and system configurations.
  - `results/`: Stores output files and results generated by the system.
- **`data/`**: Stores the M4AI dataset.


## ğŸƒâ€â™‚ Run Code

Run the framework with the following command:
```bash
python main/main.py
```


## ğŸ™ Acknowledgement

The images in the M4A1 dataset are derived from the [ActionSense](https://action-sense.csail.mit.edu/) dataset.
